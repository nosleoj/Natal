<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F√°brica de Presentes do Papai Noel - Clicker</title>
    <!-- Carrega Tailwind CSS para estiliza√ß√£o r√°pida e responsiva -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        /* Configura√ß√£o de fonte padr√£o */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1A472A; /* Verde Escuro de Natal */
            color: #fff;
        }
        /* Estilo para o bot√£o de clique (Papai Noel) */
        #click-button {
            transition: transform 0.1s ease;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5), 0 2px 4px -2px rgba(0, 0, 0, 0.6);
            border: 6px solid white;
        }
        #click-button:active {
            transform: scale(0.95);
        }
        /* Estilo para o bot√£o de compra de upgrades */
        .buy-button {
            transition: background-color 0.15s;
        }
        .buy-button:hover:enabled {
            background-color: #16A34A !important; /* Um verde mais claro ao passar o mouse */
        }
        .buy-button:disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }
        /* Cor de Fundo de Natal */
        .card-bg-enabled {
            background-color: #3D7056; /* Verde Habilitado */
        }
        .card-bg-disabled {
            background-color: #1F3829; /* Verde Desabilitado */
        }
    </style>
    <!-- C√≥digo do AdSense/AdMob (Assincrono, carregado no script) -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3384041693740985"
    crossorigin="anonymous"></script>
</head>
<body class="min-h-screen flex flex-col">

    <!-- HEADER (Placar) -->
    <header class="bg-red-700 shadow-lg p-3 sm:p-4 flex justify-between items-center z-10">
        <div class="flex flex-col sm:flex-row sm:items-baseline">
            <span class="text-yellow-200 text-sm sm:text-lg font-bold mr-2">üéÅ Presentes:</span>
            <span id="score-text-view" class="text-white text-3xl sm:text-4xl font-extrabold" style="font-family: serif;">0</span>
        </div>
        <div class="text-right">
            <span class="text-yellow-200 text-xs sm:text-sm">Por Segundo:</span>
            <span id="pps-text-view" class="text-lime-300 text-xl sm:text-2xl font-bold block">0.0 /s</span>
        </div>
    </header>

    <!-- √ÅREA PRINCIPAL -->
    <main class="flex-grow flex flex-col sm:flex-row overflow-hidden">
        
        <!-- √ÅREA DO CLICKER (Esquerda em Desktop, Cima em Mobile) -->
        <section class="flex-shrink-0 w-full sm:w-1/2 p-6 flex flex-col items-center justify-center bg-green-700 relative">
            
            <!-- Indicador de B√¥nus (Vis√≠vel quando boostActive for true) -->
            <div id="boost-indicator" class="hidden absolute top-4 p-2 rounded-lg bg-yellow-100 text-red-700 font-bold shadow-md text-sm">
                B√îNUS 2X ATIVO (<span id="boost-timer">0</span>s)
            </div>

            <!-- Bot√£o de Clique (√Årvore de Natal / Estrela) -->
            <button id="click-button" class="bg-red-700 rounded-full w-40 h-40 sm:w-56 sm:h-56 flex items-center justify-center">
                <!-- √çcone de Estrela/Presente, usando SVG para evitar depend√™ncias de imagens -->
                <svg xmlns="http://www.w3.org/2000/svg" class="h-28 w-28 text-yellow-300" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                </svg>
            </button>

            <!-- Seu c√≥digo de an√∫ncio AdSense aqui, para a √°rea de clique -->
            <div class="mt-8 p-2 bg-gray-800 rounded-lg w-full max-w-sm text-center">
                <p class="text-xs text-gray-400 mb-2">Espa√ßo de An√∫ncio AdSense (In-article)</p>
                <ins class="adsbygoogle"
                    style="display:block; text-align:center;"
                    data-ad-layout="in-article"
                    data-ad-format="fluid"
                    data-ad-client="ca-pub-3384041693740985"
                    data-ad-slot="5826635181"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>
        </section>

        <!-- √ÅREA DE UPGRADES (Direita em Desktop, Baixo em Mobile) -->
        <section class="w-full sm:w-1/2 p-4 bg-green-800 flex flex-col overflow-y-auto">
            <h2 class="text-2xl font-bold text-yellow-300 mb-4 text-center border-b-2 border-red-700 pb-2">Oficina de Melhorias</h2>
            
            <div id="upgrades-container" class="space-y-3">
                <!-- Upgrades ser√£o inseridos aqui pelo JavaScript -->
            </div>

            <!-- Bot√£o de Recompensa (Substituindo o AdMob Rewarded por um placeholder web) -->
            <button id="reward-ad-button" class="mt-4 p-3 bg-purple-700 hover:bg-purple-600 rounded-lg text-white font-bold transition">
                PRODU√á√ÉO 2X GR√ÅTIS (Simula√ß√£o de An√∫ncio)
            </button>
        </section>

    </main>

    <script>
        // --- CONFIGURA√á√ÉO E ESTADO DO JOGO ---
        let presents = 0.0;
        let clickPower = 1.0;
        let autoPresentsPerSec = 0.0;
        let boostActive = false;
        let boostTimeRemaining = 0; // em unidades de 100ms (10 unidades = 1 segundo)

        const PREFS_KEY = 'NatalClickerData';

        // --- ELEMENTOS UI ---
        const scoreDisplay = document.getElementById('score-text-view');
        const ppsDisplay = document.getElementById('pps-text-view');
        const clickButton = document.getElementById('click-button');
        const upgradesContainer = document.getElementById('upgrades-container');
        const rewardAdButton = document.getElementById('reward-ad-button');
        const boostIndicator = document.getElementById('boost-indicator');
        const boostTimerDisplay = document.getElementById('boost-timer');

        // --- ESTRUTURA DE UPGRADES ---
        class Building {
            constructor(id, name, production, baseCost, icon) {
                this.id = id;
                this.name = name;
                this.production = production;
                this.baseCost = baseCost;
                this.cost = baseCost;
                this.count = 0;
                this.icon = icon;
                this.elements = {}; // Para armazenar refer√™ncias DOM
            }
        }

        const buildings = [
            new Building('elf', 'Elfo Aprendiz', 0.1, 15, 'üéÑ'),
            new Building('cookie', 'Vov√≥ Noel', 0.5, 100, 'üç™'),
            new Building('reindeer', 'Rena Veloz', 2.0, 500, 'ü¶å'),
            new Building('sleigh', 'Tren√≥ Turbo', 5.0, 2000, 'üõ∑'),
            new Building('factory', 'F√°brica M√°gica', 20.0, 10000, 'üè≠'),
        ];

        // --- FUN√á√ïES DE L√ìGICA ---

        function formatNumber(num) {
            // Formata√ß√£o simples para inteiros grandes ou n√∫meros de ponto flutuante
            if (num >= 1000000) {
                return (num / 1000000).toFixed(2) + 'M';
            }
            if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return Math.floor(num).toLocaleString('pt-BR');
        }

        function formatPps(num) {
            return num.toFixed(1) + ' /s';
        }

        function calculatePPS() {
            autoPresentsPerSec = buildings.reduce((sum, b) => sum + (b.production * b.count), 0);
        }

        function clickPresents() {
            let amount = clickPower * (boostActive ? 2 : 1);
            presents += amount;
            updateUI();
        }

        function buyBuilding(building) {
            if (presents >= building.cost) {
                presents -= building.cost;
                building.count++;
                // Aumento de custo: 15%
                building.cost = Math.ceil(building.cost * 1.15); 
                
                calculatePPS();
                updateUI();
                saveGame();
            } else {
                showToast("Presentes insuficientes!", 'bg-red-500');
            }
        }

        function activateBoost(durationSeconds) {
            boostActive = true;
            boostTimeRemaining = durationSeconds * 10; 
            boostIndicator.classList.remove('hidden');
            showToast("B√¥nus 2X Ativo por " + durationSeconds + " segundos!", 'bg-purple-500');
        }

        // --- GERA√á√ÉO DA UI (SHOP) ---

        function renderShop() {
            upgradesContainer.innerHTML = '';
            buildings.forEach(building => {
                const card = document.createElement('div');
                card.className = `p-4 rounded-lg shadow-xl flex justify-between items-center transition duration-200 card-bg-disabled`; // Classe base para estado desabilitado
                
                // √Årea de Detalhes
                const details = document.createElement('div');
                details.innerHTML = `
                    <p class="text-xl font-bold text-white">${building.icon} ${building.name}</p>
                    <p class="text-sm text-yellow-300 mt-1">Custo: <span class="cost-value font-bold">${formatNumber(building.cost)}</span></p>
                    <p class="text-xs text-lime-300">Produ√ß√£o: +${building.production.toFixed(1)} /s</p>
                `;

                // √Årea de Compra/Contador
                const purchase = document.createElement('div');
                purchase.className = "flex items-center space-x-3";
                
                const count = document.createElement('span');
                count.className = "text-3xl font-extrabold text-white count-value w-8 text-center";
                count.textContent = building.count;

                const buyBtn = document.createElement('button');
                buyBtn.className = "buy-button px-4 py-2 bg-green-600 rounded-md text-white font-bold text-sm shadow-md transition";
                buyBtn.textContent = 'COMPRAR';
                buyBtn.onclick = () => buyBuilding(building);
                
                purchase.appendChild(count);
                purchase.appendChild(buyBtn);
                
                card.appendChild(details);
                card.appendChild(purchase);
                upgradesContainer.appendChild(card);
                
                // Armazenar refer√™ncias
                building.elements.card = card;
                building.elements.cost = card.querySelector('.cost-value');
                building.elements.count = count;
                building.elements.button = buyBtn;
            });
        }

        // --- ATUALIZA√á√ÉO DA INTERFACE ---
        
        function updateUI() {
            scoreDisplay.textContent = formatNumber(presents);
            
            let currentPps = autoPresentsPerSec * (boostActive ? 2 : 1);
            ppsDisplay.textContent = formatPps(currentPps);

            // Atualiza Upgrades
            buildings.forEach(b => {
                const canAfford = presents >= b.cost;
                
                b.elements.cost.textContent = formatNumber(b.cost);
                b.elements.count.textContent = b.count;
                
                b.elements.button.disabled = !canAfford;
                b.elements.button.style.backgroundColor = canAfford ? '#10B981' : '#4B5563'; /* Verde Esmeralda ou Cinza */
                
                // Atualiza cor de fundo do card
                b.elements.card.classList.toggle('card-bg-enabled', canAfford);
                b.elements.card.classList.toggle('card-bg-disabled', !canAfford);
            });
            
            // Atualiza indicador de Boost
            if (boostActive) {
                boostTimerDisplay.textContent = Math.ceil(boostTimeRemaining / 10);
            }
        }
        
        // --- LOOP PRINCIPAL (10x por segundo) ---

        function gameLoop() {
            // 1. Produ√ß√£o Autom√°tica
            let productionRate = autoPresentsPerSec * (boostActive ? 2 : 1);
            presents += productionRate / 10.0; 
            
            // 2. Gerenciamento do Boost
            if (boostActive) {
                boostTimeRemaining--;
                if (boostTimeRemaining <= 0) {
                    boostActive = false;
                    boostIndicator.classList.add('hidden');
                    showToast("B√¥nus 2X Expirado.", 'bg-red-500');
                }
            }

            updateUI();
            saveGame(); // Salvamento cont√≠nuo
        }

        // --- SALVAR E CARREGAR ---

        function saveGame() {
            const gameState = {
                presents: presents,
                clickPower: clickPower,
                buildings: buildings.map(b => ({
                    id: b.id,
                    count: b.count,
                    cost: b.cost
                })),
                boostActive: boostActive,
                boostTimeRemaining: boostTimeRemaining
            };
            try {
                localStorage.setItem(PREFS_KEY, JSON.stringify(gameState));
            } catch (e) {
                console.error("Erro ao salvar o jogo:", e);
            }
        }

        function loadGame() {
            try {
                const savedState = localStorage.getItem(PREFS_KEY);
                if (savedState) {
                    const gameState = JSON.parse(savedState);
                    presents = gameState.presents || 0.0;
                    clickPower = gameState.clickPower || 1.0;
                    boostActive = gameState.boostActive || false;
                    boostTimeRemaining = gameState.boostTimeRemaining || 0;

                    gameState.buildings.forEach(savedB => {
                        const existingB = buildings.find(b => b.id === savedB.id);
                        if (existingB) {
                            existingB.count = savedB.count;
                            existingB.cost = savedB.cost;
                        }
                    });
                    calculatePPS();
                }
            } catch (e) {
                console.error("Erro ao carregar o jogo:", e);
                // Se falhar, o jogo inicia com valores padr√£o
            }
        }
        
        // --- UTILIT√ÅRIO DE NOTIFICA√á√ÉO (TOAST) ---

        function showToast(message, bgColor) {
            const toast = document.createElement('div');
            toast.className = `fixed bottom-4 left-1/2 transform -translate-x-1/2 px-6 py-3 ${bgColor} text-white rounded-lg shadow-2xl transition-opacity duration-300 opacity-0 text-center font-semibold z-50`;
            toast.textContent = message;
            document.body.appendChild(toast);

            // Aparecer
            setTimeout(() => {
                toast.style.opacity = '1';
            }, 100);

            // Desaparecer
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.addEventListener('transitionend', () => toast.remove());
            }, 3000);
        }

        // --- INICIALIZA√á√ÉO ---

        document.addEventListener('DOMContentLoaded', () => {
            loadGame();
            renderShop();
            updateUI();

            // Setup Listeners
            clickButton.addEventListener('click', clickPresents);
            rewardAdButton.addEventListener('click', () => {
                // Simula√ß√£o de Ad de Recompensa (30s de boost)
                activateBoost(30); 
                // No AdMob real, isso seria ativado ap√≥s o an√∫ncio terminar
            });

            // Start Game Loop (roda a cada 100ms)
            setInterval(gameLoop, 100);
            
            // Inicia o carregamento do AdSense (j√° est√° na cabe√ßa, mas garante a inje√ß√£o)
            (window.adsbygoogle = window.adsbygoogle || []).push({});

            // Mensagem de boas-vindas
            showToast("F√°brica de Presentes Carregada!", 'bg-green-600');
        });
    </script>

</body>
</html>
